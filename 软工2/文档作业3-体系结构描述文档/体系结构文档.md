
# 软件体系结构文档模板

## 目录

- 1.引言
  - 1.1编制目的
  - 1.2词汇表
  - 1.3参考资料
- 2.产品概述
- 3.逻辑视图
- 4组合视图
  - 4.1开发包图
  - 4.2运行时进程
  - 4.3物理部署
- 5.架构设计
  - 5.1模块职责
  - 5.2用户界面层分解
  - 5.3业务逻辑层分解
  - 5.4数据层分解
- 6.信息视角

## 1.引言

### 1.1编制目的

  本报告详细完成对课程学习网站的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。

  本报告面向开发人员，测试人员及最终用户而编写，是了解系统的导航。

### 1.2词汇表

|    词汇名称    | 词汇含义     | 备注 |
| :------------: | ------------ | ---- |
| courselearning | 课程学习系统 |      |

### 1.3参考资料

《软件工程与计算（卷二）软件开发的技术基础》

## 2.产品概述

### 2.1 项目前景

#### 2.1.1 背景与机遇

- 越来越多的人期望能够更方便的学习自己想要的知识，线上的学习网站就很好的满足了人们这样的需求。
- 线下授课不方便学习者去复习和参考，线上的课程学习系统可以为学习者随时随地提供学习的条件。对于重点难点可以反复的学习。

#### 2.1.2 业务需求

- 产品名称：CourseLearning
- 网课学习平台
- 预期功能：
  1.  课程展示
  2.  学生购买观看课程
  3.  参加课程测试
  4.  进行课程评论
  5.  教师发布、管理课程
- 应用：为渴望知识的人提供一个更加方便的线上学习方式

### 2.2 项目功能

#### 2.2.1 学生

1. 个人信息查看
2. 课程信息查看
3. 课程信息搜索
4. 课程购买
5. 订单列表查看
6. 已购买课程列表查看

#### 2.2.2 教师

1. 个人信息查看
2. 课程管理
3. 课件管理

#### 2.2.3 网站管理员

1. 查看网站流量统计信息
2. 发布课程优惠券

### 2.3 用户特征

- 学生：使用课程学习系统来学习的人
- 教师：负责为课程系统创建课程、管理课件的人员
- 管理员：构建与维护整个课程系统的人员。

## 3.逻辑视图

- 处理静态设计模型

  - 在课程学习网站中，选择了分层体系结构风格，将系统分为3层（前端展示层、业务逻辑层、数据层）能够很好地示意整个高层抽象。前端展示层包含web页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。
  
- 示意图

  - 注意：逻辑表达需要更加细化

- 逻辑视角

  ![](https://ftp.bmp.ovh/imgs/2021/05/fdcfd4726f753c6b.png)

## 4.组合视图

### 4.1开发包图

- 表示软件组件在开发时环境中的静态组织
  - 描述开发包以及相互间的依赖
  - 绘制开发包图
    - 开发包图类似上述示意图画法

|         开发包         | 依赖的其他开发包                                           |
| :--------------------: | ---------------------------------------------------------- |
|         mainui         | userui,courseui,vo,courseOrderui,courseWareui,fileui       |
|        courseui        | courseblservice,界面库类包,vo                              |
|    courseblservice     |                                                            |
|        coursebl        | courseblservice,coursedataservice,courseOrderbl,po         |
|   coursedataservice    | Java RMI,po                                                |
|       coursedata       | databaseutility, po, coursedataservice,Java RMI            |
|         userui         | userblservice,界面库类包,vo                                |
|     userblservice      |                                                            |
|         userbl         | UserInterface, UserDataClient, UserPo,rechargeOrderbl      |
|    userdataservice     | Java RMI,po                                                |
|        userdata        | userdataservice,po,databaseutility,Java RMI                |
|     courseOrderui      | courseOrderblservice,界面库类包,vo                         |
|   courseOrderservice   |                                                            |
|     courseOrderbl      | courseOrderblservice,courseOrderdataservice,userbl,po      |
| courseOrderdataservice | Java RMI,po                                                |
|    courseOrderdata     | databaseutility, po, courseOrderdataservice,Java RMI       |
|     courseWarerui      | courseWareblservice,界面库类包,vo                          |
|   courseWareservice    |                                                            |
|      courseWarebl      | courseWareblservice,courseWaredataservice,courseOrderbl,po |
| courseWaredataservice  | [                                                          |
|     courseWaredata     | databaseutility, po, courseWaredataservice,Java RMI        |
|         fileui         | fileblservice,界面库类包,vo                                |
|     fileblservice      |                                                            |
|         filebl         | fileblservice,filedataservcie,po                           |
|    filedataservice     | Java RMI,po                                                |
|        filedata        | filedataservice,po,databaseutility,Java RMI                |
|           vo           |                                                            |
|           po           |                                                            |
|       utilitybl        |                                                            |
|       界面类库包       |                                                            |
|    databaseutility     | JDBC                                                       |

![](https://ftp.bmp.ovh/imgs/2021/05/3603766c13c2bd81.jpg)

### 4.2运行时进程

- 表示软件在运行时进程间的交互，描述系统的动态结构

  - 绘制进程图

- 示意图：

  ![](https://ftp.bmp.ovh/imgs/2021/05/484d6755b217bcb9.jpg)


### 4.3物理部署

- 处理如何将软件组件映射到硬件基础设施
  - 绘制部署图
- 示意图

![icon](https://img-blog.csdnimg.cn/img_convert/8c667b51987fbed1fa37b2eeb36b8223.png)

## 5.架构设计

- 描述功能分解和如何在不同的层中安排软件模块
  - 描述架构中的对象，包含架构图
  - 描述组件接口信息
    - 包括：语法、前置条件、后置条件

### 5.1模块职责

- 模块视图
- 各层职责

|     层     | 职责                                 |
| :--------: | ------------------------------------ |
|  启动模块  | 负责初始化网络通信机制，启动用户界面 |
| 用户界面层 | 展示界面                             |
| 业务逻辑层 | 对于用户界面的输入响应和业务处理逻辑 |
|   数据层   | 负责数据的持久化及数据访问接口       |

- 层之间调用接口

|         接口         | 服务调用方       | 服务提供方       |
| :------------------: | ---------------- | ---------------- |
| CourseOrderService.* | 客户端展示层     | 客户端业务逻辑层 |
|    CourseService     | 客户端展示层     | 客户端业务逻辑层 |
|  CourseWareService   | 客户端展示层     | 客户端业务逻辑层 |
|     FileService      | 客户端展示层     | 客户端业务逻辑层 |
|     UserService      | 客户端展示层     | 客户端业务逻辑层 |
|      *Mapper. *      | 客户端业务逻辑层 | 数据层           |

### 5.2用户界面层分解

#### 职责

- 类图
- 接口规范
- 需要的服务接口

|     模块      | 职责         |
| :-----------: | ------------ |
|    userUI     | 登录界面     |
|   courseUI    | 课程界面     |
| courseOrderUI | 课程订单界面 |
| courseWareUI  | 课件界面     |
|    fileUI     | 文件界面     |

#### 接口规范

**userUI需要的服务**

| 服务名                  | 服务                                                         |
| ----------------------- | ------------------------------------------------------------ |
| UserController.register | 创建新的user                                                 |
| UserController.login    | 查找是否存在相应的user，根据输入的userForm返回登陆验证的结果。 |
| UserController.getUser  | 根据输入的id查找是否存在相应的user，返回该user的表内全部数据 |
| UserController.recharge | 进行充值                                                     |

**courseUI需要的服务**

| 服务名                                | 服务                                             |
| ------------------------------------- | ------------------------------------------------ |
| CourseController.getCourseById        | 根据输入的用户id和课程id查找对应的课程，返回结果 |
| CourseController.getCoursesByKey      | 获取课程列表                                     |
| CourseController.getCoursesByType     | 根据分类标签，获取课程列表                       |
| CourseController.getBoughtCourses     | 根据输入的学生id获取用户已购买的课程列表         |
| CourseController.getManageableCourses | 根据输入的教师id获取教师可管理的课程列表         |
| CourseController.createCourse         | 教师创建课程                                     |

**courseOrderUI需要的服务**

| 服务名                                        | 服务                               |
| --------------------------------------------- | ---------------------------------- |
| CourseOrderController.createCourseOrder       | 创建课程订单                       |
| CourseOrderController.getCourseOrders         | 根据输入的用户id查询用户所有的订单 |
| CourseOrderController.updateCourseOrderStatus | 根据订单id更新订单状态             |

**courseWareUI需要的服务**

| 服务名                                | 服务                                       |
| ------------------------------------- | ------------------------------------------ |
| CourseWareController.getCourseWare    | 根据输入的用户id和课件id获取单个课件的信息 |
| CourseWareController.getCourseWares   | 获取课件列表                               |
| CourseWareController.createCourseWare | 教师创建课件                               |
| CourseWareController.updateCourseWare | 教师更新课件                               |
| CourseWareController.deleteCourseWare | 教师删除课件                               |

**fileUI需要的服务**

| 服务名                  | 服务     |
| ----------------------- | -------- |
| fileController.upload   | 上传文件 |
| fileController.download | 下载文件 |

### 5.3业务逻辑层分解

#### 5.3.1	userServiceImpl模块

1. 模块概述

   userServiceImpl模块承担的需求

   1. 用户管理（学生，教师，管理员
      1. 用户注册，同一手机号码仅能创建一账号
      2. 用户登陆
      3. 查询用户信息
   2. 用户充值
      1. 根据用户id增加用户的余额

2. 整体结构

   根据体系结构的设计，我们将系统分为了展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。展示层和业务逻辑层之间，我们添加UserService接口。业务逻辑层和数据层之间添加UserMapper接口。由UserController作为前后端的连接点。

   

   userServiceImpl模块各个类的职责

   | 模块           | 职责                           |
   | -------------- | ------------------------------ |
   | UserController | 负责用户操作所需要的服务       |
   | UserService    | 负责用户操作所需要的服务的实现 |

   

3. 模块内部类的接口规范

   UserService的接口规范

   | 接口名                   | 语法     | ResultVO<UserVO> userRegister(UserVO vo) |
   | ------------------------ | -------- | ---------------------------------------- |
   | UserService.userRegister | 前置条件 | vo符合规范，vo.phone在数据库中不存在     |
   |                          | 后置条件 | 调用userMapper.insert方法                |

   

   | 接口名                | 语法     | ResultVO<UserVO> userLogin(String phone, String password) |
   | --------------------- | -------- | --------------------------------------------------------- |
   | UserService.userLogin | 前置条件 | phone和passwd相互匹配                                     |
   |                       | 后置条件 | 返回登陆验证信息                                          |

   

   | 接口名              | 语法     | UserVO getUser(Integer uid)                 |
   | ------------------- | -------- | ------------------------------------------- |
   | UserService.getUser | 前置条件 | uid在数据库中存在                           |
   |                     | 后置条件 | 调用userMapper.selectByPrimaryKey方法并返回 |

   

   | 接口名                      | 语法     | ResultVO<UserVO> rechargeAccount(RechargeOrderVO rechargeOrderVO) |
   | --------------------------- | -------- | ------------------------------------------------------------ |
   | UserService.rechangeAccount | 前置条件 | uid在数据库里存在                                            |
   |                             | 后置条件 | 调用userMapper.increaseBalance方法                           |

   

4. 业务逻辑层的设计原理

   利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的Service。

   

#### 5.3.2	CourseOrderServiceImpl模块

1. 模块概述

   CourseOrderServiceImpl模块承担的需求

   1. 订单管理
      1. 增加新订单
      2. 对未支付订单进行支付
      3. 查看所有订单

2. 整体结构

   根据体系结构的设计，我们将系统分为了展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。展示层和业务逻辑层之间，我们添加CourseOrderService接口。业务逻辑层和数据层之间添加CourseOrderMapper接口。由CourseOrderController作为前后端的连接点。

   

   CourseOrderServiceImpl模块各个类的职责

   | 模块                  | 职责                               |
   | --------------------- | ---------------------------------- |
   | CourseOrderController | 负责订单相关操作所需要的服务       |
   | CourseOrderService    | 负责订单相关操作所需要的服务的实现 |

   

3. 模块内部类的接口规范

   CourseOrderService的接口规范

   | 接口名                              | 语法     | ResultVO<CourseOrderVO> insertCourseOrder(CourseOrderVO orderVO) |
   | ----------------------------------- | -------- | ------------------------------------------------------------ |
   | CourseOrdeService.insertCourseOrder | 前置条件 | 当前用户未购买过此课程，且没有上一笔未支付的订单             |
   |                                     | 后置条件 | 调用orderMapper.insert方法                                   |

   

   | 接口名                              | 语法     | ResultVO<CourseOrderVO> updateCourseOrder(Integer orderId, Integer orderStatus) |
   | ----------------------------------- | -------- | ------------------------------------------------------------ |
   | CourseOrdeService.updateCourseOrder | 前置条件 | orderId存在且该订单未支付且账户余额足够支付订单              |
   |                                     | 后置条件 | 调用userMapper.decreaseBalance，orderMapper.updateByPrimaryKey方法 |

   

   | 接口名                            | 语法     | List<CourseOrderVO> getCourseOrders(Integer uid) |
   | --------------------------------- | -------- | ------------------------------------------------ |
   | CourseOrdeService.getCourseOrders | 前置条件 | 无                                               |
   |                                   | 后置条件 | 调用orderMapper.selectByUserId方法并返回         |

   

4. 业务逻辑层的设计原理

   利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的Service。

#### 5.3.3	CourseServiceImpl模块

1. 模块概述

   CourseServiceImpl模块承担的需求

   1. 课程管理
      1. 课程查询
         1. 根据类型查询课程
         2. 查询全部课程
         3. 查询已购买的课程
         4. 查询自己创建的课程
         5. 根据id查询指定课程详情
         6. 查询课程详情
      2. 教师课程创建

2. 整体结构

   根据体系结构的设计，我们将系统分为了展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。展示层和业务逻辑层之间，我们添加CourseService 接口。业务逻辑层和数据层之间添加CourseMapper，CourseOrderMapper接口。由CourseController作为前后端的连接点。

   

   CourseServiceImpl模块各个类的职责

   | 模块             | 职责                           |
   | ---------------- | ------------------------------ |
   | CourseController | 负责课程操作所需要的服务       |
   | CourseService    | 负责课程操作所需要的服务的实现 |

   

3. 模块内部类的接口规范

   CourseService 的接口规范

   | 接口名                    | 语法     | PageInfo<CourseVO> getCourses(Integer currPage, Integer pageSize, Integer uid, String key) |
   | ------------------------- | -------- | ------------------------------------------------------------ |
   | CourseService .getCourses | 前置条件 | currPage符合规范                                             |
   |                           | 后置条件 | 调用courseMapper.queryAll方法，分页后返回                    |

   

   | 接口名                          | 语法     | PageInfo<CourseVO> getCoursesByType(Integer currPage, Integer pageSize, Integer uid, String type) |
   | ------------------------------- | -------- | ------------------------------------------------------------ |
   | CourseService .getCoursesByType | 前置条件 | currPage符合规范                                             |
   |                                 | 后置条件 | 调用courseMapper.queryAll方法，分页后返回                    |

   

   | 接口名                          | 语法     | List<CourseVO> getBoughtCourses(Integer uid) |
   | ------------------------------- | -------- | -------------------------------------------- |
   | CourseService .getBoughtCourses | 前置条件 | 无                                           |
   |                                 | 后置条件 | 调用courseMapper.selectByStudentId方法并返回 |

   

   

   | 接口名                              | 语法     | List<CourseVO> getManageableCourses(Integer uid) |
   | ----------------------------------- | -------- | ------------------------------------------------ |
   | CourseService .getManageableCourses | 前置条件 | 无                                               |
   |                                     | 后置条件 | 调用courseMapper.selectByTeacherId方法           |

   

   | 接口名                   | 语法     | CourseVO getCourse(Integer courseId, Integer uid) |
   | ------------------------ | -------- | ------------------------------------------------- |
   | CourseService .getCourse | 前置条件 | 该课程已被用户购买                                |
   |                          | 后置条件 | 调用courseMapper.selectByTeacherId方法接口名      |

   

   | 接口名                      | 语法     | ResultVO<CourseVO> createCourse(CourseVO courseVO) |
   | --------------------------- | -------- | -------------------------------------------------- |
   | CourseService .createCourse | 前置条件 | 数据库中无同名课程                                 |
   |                             | 后置条件 | 调用courseMapper.insert方法                        |

   

   | 接口名                             | 语法     | PageInfo<CourseVO> getCourseVOPageInfo(Integer uid, PageInfo<Course> po) |
   | ---------------------------------- | -------- | ------------------------------------------------------------ |
   | CourseService .getCourseVOPageInfo | 前置条件 | 无                                                           |
   |                                    | 后置条件 | 调用orderMapper.queryMostRecentOrder                         |

4. 业务逻辑层的设计原理

   利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的Service。

#### 5.3.4	CourseWareServiceImpl模块

1. 模块概述

   CourseWareServiceImpl模块承担的需求

   1. 课件管理
      1. 查看课件
         1. 根据id查看课件查看全部课件
         2. 查看全部课件
      2. 创建课件
      3. 更新课件
      4. 删除课件

2. 整体结构

   根据体系结构的设计，我们将系统分为了展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。展示层和业务逻辑层之间，我们添加CourseWareService接口。业务逻辑层和数据层之间添加CourseWareMapper，courseOrderMapper接口。由CourseWareController作为前后端的连接点。

   

   CourseWareServiceImpl模块各个类的职责

   | 模块                 | 职责                           |
   | -------------------- | ------------------------------ |
   | CourseWareController | 负责课件操作所需要的服务       |
   | CourseWareService    | 负责课件操作所需要的服务的实现 |

   

3. 模块内部类的接口规范

   CourseWareService的接口规范

   | 接口名                          | 语法     | CourseWareVO getCourseWare(Integer uid, Integer courseWareId) |
   | ------------------------------- | -------- | ------------------------------------------------------------ |
   | CourseWareService.getCourseWare | 前置条件 | uid存在                                                      |
   |                                 | 后置条件 | 调用courseOrderMapper.queryMostRecentOrder方法并返回         |

   

   | 接口名                             | 语法     | List<CourseWareVO> getAllCourseWare(Integer uid, Integer courseId) |
   | ---------------------------------- | -------- | ------------------------------------------------------------ |
   | CourseWareService.getAllCourseWare | 前置条件 | uid存在                                                      |
   |                                    | 后置条件 | 调用courseOrderMapper.queryMostRecentOrder，courseWareMapper.selectByCourseId并返回 |

   

   | 接口名                             | 语法     | ResultVO<CourseWareVO> createCourseWare(CourseWareVO courseWareVO) |
   | ---------------------------------- | -------- | ------------------------------------------------------------ |
   | CourseWareService.createCourseWare | 前置条件 | 无                                                           |
   |                                    | 后置条件 | 调用courseWareMapper.insert方法                              |

   

   | 接口名                             | 语法     | ResultVO<CourseWareVO> updateCourseWare(CourseWareVO courseWareVO) |
   | ---------------------------------- | -------- | ------------------------------------------------------------ |
   | CourseWareService.updateCourseWare | 前置条件 | 无                                                           |
   |                                    | 后置条件 | 调用courseWareMapper.updateByPrimaryKey方法                  |

   

   | 接口名                             | 语法     | ResultVO<String> deleteCourseWare(Integer courseWareId) |
   | ---------------------------------- | -------- | ------------------------------------------------------- |
   | CourseWareService.deleteCourseWare | 前置条件 | 课件存在                                                |
   |                                    | 后置条件 | 调用courseWareMapper.deleteByPrimaryKey方法             |

   

4. 业务逻辑层的设计原理

   利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的Service。

#### 5.3.5	FileServiceImpl 模块

1. 模块概述

   FileServiceImpl 模块承担的需求

   1. 文件管理
      1. 文件下载
      2. 文件上传
   
2. 整体结构

   根据体系结构的设计，我们将系统分为了展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。展示层和业务逻辑层之间，我们添加FileService接口。业务逻辑层和数据层之间添加FileHelper接口(工具类）。由FileController作为前后端的连接点。

   

   FileServiceImpl 模块各个类的职责

   | 模块           | 职责                           |
   | -------------- | ------------------------------ |
   | FileController | 负责文件操作所需要的服务       |
   | FileService    | 负责用户操作所需要的服务的实现 |

   

3. 模块内部类的接口规范

   FileService的接口规范

   | 接口名                 | 语法     | ResultVO<FileInfoVO> uploadFile(MultipartFile file) |
   | ---------------------- | -------- | --------------------------------------------------- |
   | FileService.uploadFile | 前置条件 | 路径有效                                            |
   |                        | 后置条件 | 调用FileHelper.save方法                             |

   

   | 接口名                   | 语法     | downloadFile(String originName, String newName, HttpServletResponse response) |
   | ------------------------ | -------- | ------------------------------------------------------------ |
   | FileService.downloadFile | 前置条件 | 无                                                           |
   |                          | 后置条件 | 调用FileHelper.loadFileAsResource并返回                      |

4. 业务逻辑层的设计原理

   利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的Service。

### 5.4数据层分解

#### 职责
| 模块          | 职责                                                         |
| ------------- | ------------------------------------------------------------ |
| CourseMapper | 基于Course的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| CourseOrderMapper   | 基于CourseOrder的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| CourseWareMapper   | 基于CourseWare的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| RechargeOrderMapper    | 基于RechargeOrder的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| UserMapper   | 基于Order的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

#### 接口规范
##### CourseMapper

| 接口名                          | 语法         | int deleteByPrimaryKey(Integer id);|
| ------------------------------- | :----------- | -------------------------------- |
| CourseMapper.deleteByPrimaryKey | **前置条件** | 存在主键id对应的课程             |
|                                 | **后置条件** |删除主键为id的课程                   |

| 接口名                          | 语法         | int insert(Course record); |
| ------------------------------- | :----------- | ---------------------------------------------------- |
| CourseMapper. insert | **前置条件** | 无                                                   |
|                                 | **后置条件** | 创建一个Course                   |

| 接口名                        | 语法         | Course selectByPrimaryKey(Integer id); |
| ----------------------------- | :----------- | ----------------------------------------- |
| CourseMapper. selectByPrimaryKey| **前置条件** | 存在主键id对应的课程                                        |
|                               | **后置条件** | 按id查找并返回相应的Course结果              |

| 接口名                       | 语法         |List\<Course> selectAll(); |
| ---------------------------- | :----------- | ------------------------------------------------------------ |
| CourseMapper. selectAll| **前置条件** | 无                                |
|                              | **后置条件** | 返回包含所有的Course的列表                                     |

| 接口名                       | 语法         |int updateByPrimaryKey(Course record); |
| ---------------------------- | :----------- | ------------------------------------------------------------ |
| CourseMapper. updateByPrimaryKey| **前置条件** | 在数据库中存在同样id的Course                      |
| | **后置条件** | 更新一个Course |
| 接口名                     | 语法         | List\<Course> selectByType(String type); |
| -------------------------- | :----------- | ---------------------------------------- |
| CourseMapper. selectByType | **前置条件** | 无                                       |
|                            | **后置条件** | 按Type查找返回相应的Course结果           |
| 接口名                       | 语法         |List\<Course> queryAll(String key); |
| ---------------------------- | :----------- | ------------------------------------------------------------ |
| CourseMapper. queryAll| **前置条件** | 无                      |
| | **后置条件** | 按key进行匹配查找返回相应的Course结果 |
| 接口名                       | 语法         | List\<Course> selectByTeacherId(Integer userId); |
| ---------------------------- | :----------- | ------------------------------------------------------------ |
| CourseMapper. selectByTeacherId| **前置条件** | 数据库存在userId对应的教师用户              |
| | **后置条件** | 按userId查找返回相应的Course结果 |
| 接口名                       | 语法         | List\<Course> selectByStudentId(Integer userId); |
| ---------------------------- | :----------- | ------------------------------------------------------------ |
| CourseMapper. selectByStudentId| **前置条件** | 数据库存在userId对应的学生用户              |
| | **后置条件** | 按userId查找返回相应的Course结果 |
### CourseOrderMapper

| 接口名                  | 语法         | int deleteByPrimaryKey(Integer id); |
| ----------------------- | :----------- | -------------------------- |
| CourseOrderMapper. deleteByPrimaryKey| **前置条件** | 存在id对应的课程订单         |
|                         | **后置条件** | 删除主键为id的课程订单        |

| 接口名                      | 语法         | int insert(CourseOrder record); |
| --------------------------- | :----------- | ------------------------------ |
| CourseOrderMapper. insert| **前置条件** | 无                             |
|                             | **后置条件** | 创建一个CourseOrder         |

| 接口名                      | 语法         | CourseOrder selectByPrimaryKey(Integer id); |
| --------------------------- | :----------- | ------------------------------ |
| CourseOrderMapper. selectByPrimaryKey| **前置条件** | 存在主键id对应的课程订单                       |
|                             | **后置条件** | 按id查找并返回相应的CourseOrder结果      |

| 接口名                      | 语法         | List\<CourseOrder> selectAll(); |
| --------------------------- | :----------- | ------------------------------ |
| CourseOrderMapper. selectAll| **前置条件** | 无                       |
|                             | **后置条件** | 返回包含所有的CourseOrder的列表      |

| 接口名                      | 语法         | int updateByPrimaryKey(CourseOrder record); |
| --------------------------- | :----------- | ------------------------------ |
| CourseOrderMapper. updateByPrimaryKey| **前置条件** | 在数据库中存在同样id的CourseOrder                      |
|                             | **后置条件** | 更新一个CourseOrder      |

| 接口名                      | 语法         | List\<CourseOrder> selectByUserId(Integer userId); |
| --------------------------- | :----------- | ------------------------------ |
| CourseOrderMapper. selectByUserId| **前置条件** | 无                     |
|                             | **后置条件** | 按UserId查找返回相应的CourseOrder结果    |

| 接口名                      | 语法         | CourseOrder queryMostRecentOrder(Integer userId, Integer courseId); |
| --------------------------- | :----------- | ------------------------------ |
| CourseOrderMapper. queryMostRecentOrder| **前置条件** | 存在userId订阅的courseId课程订单          |
|                             | **后置条件** | 按UserId和courseId查找最近时间的CourseOrder结果    |

##### CourseWareMapper

| 接口名                   | 语法         | int deleteByPrimaryKey(Integer id); |
| ------------------------ | :----------- | ----------------------------- |
| CourseWareMapper. deleteByPrimaryKey| **前置条件** | 存在id对应的课件           |
|                          | **后置条件** | 删除主键为id的课件            |

| 接口名                      | 语法         | int insert(CourseWare record); |
| --------------------------- | :----------- | --------------------------------- |
| CourseWareMapper. insert| **前置条件** | 无                                |
|                             | **后置条件** | 创建一个CourseWare         |

| 接口名                  | 语法         | CourseWare selectByPrimaryKey(Integer id); |
| ----------------------- | :----------- | -------------------------------------------- |
| CourseWare . selectByPrimaryKey| **前置条件** | 存在主键id对应的课件                  |
|                         | **后置条件** | 按id查找并返回相应的CourseWare结果                   |

| 接口名                  | 语法         | List\<CourseWare> selectAll();|
| ----------------------- | :----------- | -------------------------------------------- |
| CourseWare . selectAll| **前置条件** | 无                  |
|                         | **后置条件** | 返回包含所有的CourseWare的列表                  |

| 接口名                  | 语法         |  int updateByPrimaryKey(CourseWare record);|
| ----------------------- | :----------- | -------------------------------------------- |
| CourseWare . updateByPrimaryKey| **前置条件** | 在数据库中存在同样id的CourseWare                  |
|                         | **后置条件** | 更新一个CourseWare               |

| 接口名                  | 语法         | List\<CourseWare> selectByCourseId(Integer courseId);|
| ----------------------- | :----------- | -------------------------------------------- |
| CourseWare . selectByCourseId| **前置条件** | 无                 |
|                         | **后置条件** | 按courseId查找返回相应的CourseWare结果         |

##### RechargeOrderMapper

| 接口名                     | 语法         | int deleteByPrimaryKey(Integer orderId); |
| -------------------------- | :----------- | ------------------------------------------------------------ |
| RechargeOrderMapper. deleteByPrimaryKey| **前置条件** | 存在id对应的rechargeOrder                                     |
|                            | **后置条件** |           删除主键为id的rechargeOrder                      |

| 接口名                 | 语法         | int insert(RechargeOrder record); |
| ---------------------- | :----------- | ------------------------------------ |
| RechargeOrderMapper. insert| **前置条件** | 无            |
|                        | **后置条件** | 创建一个RechargeOrder                     |

| 接口名                           | 语法         | RechargeOrder selectByPrimaryKey(Integer orderId);|
| -------------------------------- | :----------- | ------------------------------------------------------------ |
| RechargeOrderMapper. selectByPrimaryKey| **前置条件** | 存在主键id对应的rechargeOrder                                         |
|                                  | **后置条件** | 按id查找并返回相应的RechargeOrder结果                        |

| 接口名                    | 语法         | List\<RechargeOrder> selectAll();|
| ------------------------- | :----------- | ------------------------------------------------------------ |
| RechargeOrderMapper. selectAll| **前置条件** | 无                                                           |
|                           | **后置条件** | 返回包含所有的RechargeOrder的列表        |

| 接口名                    | 语法         |  int updateByPrimaryKey(RechargeOrder record);|
| ------------------------- | :----------- | ------------------------------------------------------------ |
| RechargeOrderMapper. updateByPrimaryKey| **前置条件** | 在数据库中存在同样id的RechargeOrder                                                           |
|                           | **后置条件** | 更新一个RechargeOrder        |

##### UserMapper

| 接口名                | 语法         |  int deleteByPrimaryKey(Integer id);|
| --------------------- | :----------- | -------------------------- |
| UserMapper. deleteByPrimaryKey| **前置条件** | 存在id对应的user        |
|                       | **后置条件** | 删除主键为id的user              |

| 接口名                    | 语法         |  int insert(User record);|
| ------------------------- | :----------- | ----------------------------- |
| UserMapper. insert| **前置条件** | 无                            |
|                           | **后置条件** | 创建一个User      |

| 接口名                     | 语法         | User selectByPrimaryKey(Integer id); |
| -------------------------- | :----------- | --------------------------------------------------------- |
| UserMapper. selectByPrimaryKey| **前置条件** | 存在主键id对应的user                            |
|                            | **后置条件** | 按id查找并返回相应的user结果         |

| 接口名                     | 语法         | List\<User> selectAll(); |
| -------------------------- | :----------- | --------------------------------------------------------- |
| UserMapper. selectAll| **前置条件** | 无              |
|                            | **后置条件** | 返回包含所有的user的列表       |


| 接口名                     | 语法         | int updateByPrimaryKey(User record); |
| -------------------------- | :----------- | --------------------------------------------------------- |
| UserMapper. updateByPrimaryKey| **前置条件** | 在数据库中存在同样id的user            |
|                            | **后置条件** | 更新一个user    |

| 接口名                     | 语法         |  void increaseBalance(@Param(value = "id") Integer id, @Param(value = "delta")Integer delta);|
| -------------------------- | :----------- | --------------------------------------------------------- |
| UserMapper. increaseBalance| **前置条件** | 在数据库中存在同样id的user            |
|                            | **后置条件** | 该user余额加上delta    |

| 接口名                     | 语法         |   void decreaseBalance(@Param(value = "id") Integer id, @Param(value = "delta")Integer delta);|
| -------------------------- | :----------- | --------------------------------------------------------- |
| UserMapper. decreaseBalance| **前置条件** | 在数据库中存在同样id的user            |
|                            | **后置条件** | 该user余额减去delta    |

| 接口名                     | 语法         |   User selectByPhone(String phone);|
| -------------------------- | :----------- | --------------------------------------------------------- |
| UserMapper. selectByPhone| **前置条件** | 无      |
|                            | **后置条件** | 按phone查找返回相应的user结果   |



## 6.信息视角

- 描述数据持久化对象(PO)
  - 属性及其定义

    1. **Course类**

       包含了课程id、课程名称、课程种类、课程介绍、课程封面图片、所属学校、创建时间、删除时间、价格、教师id、教师名字

       ```java
       public class Course {
           private Integer id;
       
           private String name;
       
           private String type;
       
           private String intro;
       
           private String picture;
       
           private String school;
       
           private Date createTime;
       
           private Date deleteTime;
       
           private Integer cost;
       
           private Integer teacherId;
       
           private String teacherName;
       
           public Integer getId() {
               return id;
           }
       
           public void setId(Integer id) {
               this.id = id;
           }
       
           public String getName() {
               return name;
           }
       
           public void setName(String name) {
               this.name = name == null ? null : name.trim();
           }
       
           public String getType() {
               return type;
           }
       
           public void setType(String type) {
               this.type = type == null ? null : type.trim();
           }
       
           public String getIntro() {
               return intro;
           }
       
           public void setIntro(String intro) {
               this.intro = intro == null ? null : intro.trim();
           }
       
           public String getPicture() {
               return picture;
           }
       
           public void setPicture(String picture) {
               this.picture = picture == null ? null : picture.trim();
           }
       
           public String getSchool() {
               return school;
           }
       
           public void setSchool(String school) {
               this.school = school == null ? null : school.trim();
           }
       
           public Date getCreateTime() {
               return createTime;
           }
       
           public void setCreateTime(Date createTime) {
               this.createTime = createTime;
           }
       
           public Date getDeleteTime() {
               return deleteTime;
           }
       
           public void setDeleteTime(Date deleteTime) {
               this.deleteTime = deleteTime;
           }
       
           public Integer getCost() {
               return cost;
           }
       
           public void setCost(Integer cost) {
               this.cost = cost;
           }
       
           public Integer getTeacherId() {
               return teacherId;
           }
       
           public void setTeacherId(Integer teacherId) {
               this.teacherId = teacherId;
           }
       
           public String getTeacherName() {
               return teacherName;
           }
       
           public void setTeacherName(String teacherName) {
               this.teacherName = teacherName == null ? null : teacherName.trim();
           }
       
           public Course() {
           }
       
           public Course(@NonNull CourseVO courseVO){
               this.id = courseVO.getId();
               this.name = courseVO.getName();
               this.type = courseVO.getType();
               this.intro = courseVO.getIntro();
               this.picture = courseVO.getPicture();
               this.school = courseVO.getSchool();
               this.createTime = courseVO.getCreateTime();
               this.cost = courseVO.getCost();
               this.teacherId = courseVO.getTeacherId();
               this.teacherName = courseVO.getTeacherName();
           }
       }
       ```

    2. **CourseOrder类**

       包含课程订单的id、价格、课程id、课程名称、创建时间、用户id、订单状态

       ```java
       public class CourseOrder {
           private Integer id;
       
           private Integer cost;
       
           private Integer courseId;
       
           private String courseName;
       
           private Date createTime;
       
           private Integer userId;
       
           private Integer status;
       
           public Integer getId() {
               return id;
           }
       
           public void setId(Integer id) {
               this.id = id;
           }
       
           public Integer getCost() {
               return cost;
           }
       
           public void setCost(Integer cost) {
               this.cost = cost;
           }
       
           public Integer getCourseId() {
               return courseId;
           }
       
           public void setCourseId(Integer courseId) {
               this.courseId = courseId;
           }
       
           public String getCourseName() {
               return courseName;
           }
       
           public void setCourseName(String courseName) {
               this.courseName = courseName == null ? null : courseName.trim();
           }
       
           public Date getCreateTime() {
               return createTime;
           }
       
           public void setCreateTime(Date createTime) {
               this.createTime = createTime;
           }
       
           public Integer getUserId() {
               return userId;
           }
       
           public void setUserId(Integer userId) {
               this.userId = userId;
           }
       
           public Integer getStatus() {
               return status;
           }
       
           public void setStatus(Integer status) {
               this.status = status;
           }
       
           public CourseOrder() {
           }
       
           public CourseOrder(@NonNull CourseOrderVO orderVO){
               this.id = orderVO.getId();
               this.cost = orderVO.getCost();
               this.courseId = orderVO.getCourseId();
               this.courseName = orderVO.getCourseName();
               this.createTime = orderVO.getCreateTime()==null ? new Date():orderVO.getCreateTime();
               this.userId = orderVO.getUserId();
               this.status = orderVO.getStatus();
           }
       }
       ```

    3. **CourseWare类**

       包含课件的id、课程id、编号、课件名称、文件名称、文件类型、文件大小、上传时间、免费标签、下载标签

       ```java
       public class CourseWare {
           private Integer id;
       
           private Integer courseId;
       
           private Integer number;
       
           private String title;
       
           private String fileName;
       
           private String fileType;
       
           private String fileSize;
       
           private Boolean freeFlag;
       
           private Boolean downloadFlag;
       
           private Date uploadTime;
       
           public Integer getId() {
               return id;
           }
       
           public void setId(Integer id) {
               this.id = id;
           }
       
           public Integer getCourseId() {
               return courseId;
           }
       
           public void setCourseId(Integer courseId) {
               this.courseId = courseId;
           }
       
           public Integer getNumber() {
               return number;
           }
       
           public void setNumber(Integer number) {
               this.number = number;
           }
       
           public String getTitle() {
               return title;
           }
       
           public void setTitle(String title) {
               this.title = title == null ? null : title.trim();
           }
       
           public String getFileName() {
               return fileName;
           }
       
           public void setFileName(String fileName) {
               this.fileName = fileName == null ? null : fileName.trim();
           }
       
           public String getFileType() {
               return fileType;
           }
       
           public void setFileType(String fileType) {
               this.fileType = fileType == null ? null : fileType.trim();
           }
       
           public String getFileSize() {
               return fileSize;
           }
       
           public void setFileSize(String fileSize) {
               this.fileSize = fileSize == null ? null : fileSize.trim();
           }
       
           public Boolean getFreeFlag() {
               return freeFlag;
           }
       
           public void setFreeFlag(Boolean freeFlag) {
               this.freeFlag = freeFlag;
           }
       
           public Boolean getDownloadFlag() {
               return downloadFlag;
           }
       
           public void setDownloadFlag(Boolean downloadFlag) {
               this.downloadFlag = downloadFlag;
           }
       
           public Date getUploadTime() {
               return uploadTime;
           }
       
           public void setUploadTime(Date uploadTime) {
               this.uploadTime = uploadTime;
           }
       
           public CourseWare() {
           }
           
           public CourseWare(@NonNull CourseWareVO courseWareVO){
               id = courseWareVO.getId();
               courseId = courseWareVO.getCourseId();
               number = courseWareVO.getNumber();
               title = courseWareVO.getTitle();
               fileName = courseWareVO.getFileName();
               fileType = courseWareVO.getFileType();
               fileSize = courseWareVO.getFileSize();
               freeFlag = courseWareVO.getFreeFlag();
               downloadFlag = courseWareVO.getDownloadFlag();
               uploadTime = courseWareVO.getUploadTime();
           }
       }
       ```

    4. **RechargeOrder类**

       包含订单id、用户id、充值金额、创建时间

       ```java
       public class RechargeOrder {
           private Integer orderId;
       
           private Integer userId;
       
           private Integer value;
       
           private Date createTime;
       
           public Integer getOrderId() {
               return orderId;
           }
       
           public void setOrderId(Integer orderId) {
               this.orderId = orderId;
           }
       
           public Integer getUserId() {
               return userId;
           }
       
           public void setUserId(Integer userId) {
               this.userId = userId;
           }
       
           public Integer getValue() {
               return value;
           }
       
           public void setValue(Integer value) {
               this.value = value;
           }
       
           public Date getCreateTime() {
               return createTime;
           }
       
           public void setCreateTime(Date createTime) {
               this.createTime = createTime;
           }
       
           public RechargeOrder() {
           }
       
           public RechargeOrder(RechargeOrderVO rechargeOrder) {
               this.orderId = rechargeOrder.getOrderId();
               this.userId = rechargeOrder.getUserId();
               this.value = rechargeOrder.getValue();
               this.createTime = rechargeOrder.getCreateTime();
           }
       }
       ```

    5. **User类**

       包含用户id、用户名、手机号、密码、头像图片、用户类型、创建时间、账户余额

       ```java
       public class User {
           private Integer id;
       
           private String uname;
       
           private String phone;
       
           private String password;
       
           private String picture;
       
           private Integer balance;
       
           private UserRole userRole;
       
           private Date createTime;
       
           public Integer getId() {
               return id;
           }
       
           public void setId(Integer id) {
               this.id = id;
           }
       
           public String getUname() {
               return uname;
           }
       
           public void setUname(String uname) {
               this.uname = uname == null ? null : uname.trim();
           }
       
           public String getPhone() {
               return phone;
           }
       
           public void setPhone(String phone) {
               this.phone = phone == null ? null : phone.trim();
           }
       
           public String getPassword() {
               return password;
           }
       
           public void setPassword(String password) {
               this.password = password == null ? null : password.trim();
           }
       
           public String getPicture() {
               return picture;
           }
       
           public void setPicture(String picture) {
               this.picture = picture == null ? null : picture.trim();
           }
       
           public Integer getBalance() {
               return balance;
           }
       
           public void setBalance(Integer balance) {
               this.balance = balance;
           }
       
           public UserRole getUserRole() {
               return userRole;
           }
       
           public void setUserRole(UserRole userRole) {
               this.userRole = userRole;
           }
       
           public Date getCreateTime() {
               return createTime;
           }
       
           public void setCreateTime(Date createTime) {
               this.createTime = createTime;
           }
       
           public User() {
           }
       
           public User(UserVO userVO){
               id = userVO.getId();
               uname = userVO.getUname();
               phone = userVO.getPhone();
               password = userVO.getPassword();
               picture = userVO.getPicture();
               balance = userVO.getBalance();
               userRole = userVO.getUserRole();
               createTime = userVO.getCreateTime();
           }
       }
       ```

       